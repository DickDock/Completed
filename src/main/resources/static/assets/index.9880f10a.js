var d=Object.defineProperty;var B=(s,u,r)=>u in s?d(s,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[u]=r;var F=(s,u,r)=>(B(s,typeof u!="symbol"?u+"":u,r),r);import{a as m}from"./axios.7aed06b8.js";import{i as C}from"./element-plus.9eade698.js";const D=m.CancelToken;let c=[],p=s=>{for(let u in c)c[u].umet===s.url+"&"+s.method&&(c[u].cancel("\u5DF2\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF0C\u8BF7\u52FF\u91CD\u590D\u8BF7\u6C42"),c.splice(u,1))};class h{constructor(){F(this,"baseURL");F(this,"timeout");this.baseURL="http://127.0.0.1:8080",this.timeout=1500}getConfigParams(){return{baseURL:this.baseURL,timeout:this.timeout,headers:{}}}interceptors(u,r){u.interceptors.request.use(e=>{if(p(e),e.cancelToken=new D(o=>{c.push({umet:e.url+"&"+e.method,cancel:o})}),e.headers["Content-Type"]="application/json;charset=utf-8",e.method==="get"&&e.params){let o=e.url+"?";for(const l of Object.keys(e.params)){const n=e.params[l];var t=encodeURIComponent(l)+"=";if(n!==null&&typeof n!="undefined")if(typeof n=="object")for(const i of Object.keys(n)){let E=l+"["+i+"]";var a=encodeURIComponent(E)+"=";o+=a+encodeURIComponent(n[i])+"&"}else o+=t+encodeURIComponent(n)+"&"}o=o.slice(0,-1),e.params={},e.url=o}return e},e=>Promise.reject(e)),u.interceptors.response.use(e=>{p(e.config);const t=e.data.code||200;let a=e.data.msg||"";switch(t){case"200":a="\u8BF7\u6C42\u6210\u529F";break;case"401":a="\u8BA4\u8BC1\u5931\u8D25\uFF0C\u65E0\u6CD5\u8BBF\u95EE\u7CFB\u7EDF\u8D44\u6E90";break;case"403":a="\u5F53\u524D\u64CD\u4F5C\u6CA1\u6709\u6743\u9650";break;case"404":a="\u8BBF\u95EE\u8D44\u6E90\u4E0D\u5B58\u5728";break;case"default":a="\u7CFB\u7EDF\u672A\u77E5\u9519\u8BEF\uFF0C\u8BF7\u53CD\u9988\u7ED9\u7BA1\u7406\u5458";break;default:a="\u672A\u77E5\u9519\u8BEF\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458";break}return t===200?Promise.resolve(e.data):(C.error(a),Promise.reject(e.data))},e=>{console.log("err"+e);let{message:t}=e;return t=="Network Error"?t="\u540E\u7AEF\u63A5\u53E3\u8FDE\u63A5\u5F02\u5E38":t.includes("timeout")?t="\u7CFB\u7EDF\u63A5\u53E3\u8BF7\u6C42\u8D85\u65F6":t.includes("Request failed with status code")&&(t="\u7CFB\u7EDF\u63A5\u53E3"+t.substr(t.length-3)+"\u5F02\u5E38"),C.error({message:t,duration:5*1e3}),Promise.reject(e)})}request(u){const r=m.create();return u=Object.assign(this.getConfigParams(),u),this.interceptors(r,u.url),r(u)}}const b=new h,j=()=>b.request({url:"api/users",method:"GET"});export{j as g};
